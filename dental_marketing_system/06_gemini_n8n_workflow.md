# 06. Gemini API 기반 n8n 콘텐츠 자동화 워크플로우 설계

ChatGPT 대신 구글의 **Gemini API(Gemini 1.5 Pro/Flash 등)**를 활용하여, 에이전시 내부 인력이 버튼 하나만 누르면 [블로그 원고 + 인스타 카드뉴스 대본 + 유튜브 쇼츠 스크립트]가 노션(Notion)에 자동으로 정리되는 n8n 워크플로우 설계도입니다.

---

## 1. n8n 워크플로우 전체 아키텍처 (시나리오)

*   **[Trigger]** 구글 시트(Google Sheets)에 에이전시 직원이 '치과명', '키워드', '원장님 핵심 메모 3줄'을 입력하면 n8n이 동작을 시작합니다.
*   **[Step 1]** Gemini API가 메모를 바탕으로 'SEO 블로그 포스팅 초안'을 작성합니다.
*   **[Step 2]** Gemini API가 완성된 블로그 글을 바탕으로 '카드뉴스 5장 텍스트'로 요약 발췌합니다.
*   **[Step 3]** Gemini API가 '1분 숏폼 스크립트'를 생성합니다.
*   **[Step 4]** 생성된 3가지 결과물이 구글 문서(Google Docs)나 구글 시트(Google Sheets)에 깔끔하게 자동 작성됩니다.
*   **[Step 5]** 카카오톡 챗봇이나 디스코드/슬랙(Slack)으로 "원고가 생성되었습니다. 링크에서 검수해 주세요"라는 알림을 보냅니다.

---

## 2. n8n 노드(Node) 구성 상세 가이드

n8n 캔버스에 아래 순서대로 노드를 연결합니다.

### Node 1. Google Sheets Trigger (또는 Webhook)
- **설정:** 에이전시에서 관리하는 "치과 콘텐츠 기획 시트"를 연결.
- **감지:** 직원이 시트에 새로운 행(Row)을 추가할 때 구동되도록 설정.
  - *컬럼 예시:* `병원명(A)`, `타겟키워드(B)`, `원장님 코멘트(C)`, `진행상태(D)`

### Node 2. Google Gemini (블로그 글쓰기)
- **Operation:** Generate Text 
- **Model:** `gemini-1.5-pro` (전문적이고 긴 글쓰기, 구조화에 강함)
- **System Prompt:**
  > "당신은 15년 임상 경력을 가진 [{{$json.병원명}}]의 구강악안면외과 대표원장입니다. 
  > 타겟 독자는 수술 통증과 비용을 두려워하는 40~60대 환자입니다.
  > 전문적이지만 친절하고, 논리적인 평어(~습니다, ~합니다)를 사용하세요. 
  > 과장 광고(최고, 완치 등)는 절대 사용하지 마세요."
- **User Prompt:**
  > "다음 키워드와 원장님 코멘트를 바탕으로 SEO에 최적화된 1500자 분량의 네이버 블로그 포스팅을 마크다운(Markdown) H1, H2 구조로 작성해 주세요.
  > - 타겟 키워드: {{$json.타겟키워드}}
  > - 원장님 코멘트: {{$json.원장님코멘트}}"

### Node 3. Google Gemini (카드뉴스 추출)
- **Operation:** Generate Text
- **Model:** `gemini-1.5-flash` (빠른 요약 용도)
- **User Prompt:**
  > "방금 작성된 블로그 원고를 인스타그램 카드뉴스 5장 분량으로 요약해 주세요.
  > 각 슬라이드별로 들어갈 메인 카피(15자 이내)와 서브 텍스트(30자 이내)를 분리해서 넘버링해 주세요.
  > - 원본 원고: {{$node["Google Gemini (블로그)"].json.text}}"

### Node 4. Google Gemini (숏폼 스크립트 추출)
- **Operation:** Generate Text
- **Model:** `gemini-1.5-flash`
- **User Prompt:**
  > "방금 작성된 블로그 원고를 원장님이 카메라 앞에서 직접 읽을 '1분 유튜브 쇼츠 대본'으로 변환해 주세요.
  > 인사는 '안녕하세요, [{{$json.병원명}}] 대표원장입니다'로 시작하고, 
  > 말하듯이 자연스러운 구어체(~요)로 작성해 주세요. 행동 지문(예: 모형을 가리키며)도 넣어주세요.
  > - 원본 원고: {{$node["Google Gemini (블로그)"].json.text}}"

### Node 5. Google Docs (최종 원고 병합 및 문서 생성)
- **Operation:** Create Document
- **문서 제목:** `[{{$json.병원명}}] {{$json.타겟키워드}} 초안`
- **본문 구성 (Append Text):**
  - **[블로그 초안]** `{{$node["Google Gemini (블로그)"].json.text}}`
  - **[카드뉴스 초안]** `{{$node["Google Gemini (카드뉴스)"].json.text}}`
  - **[숏폼 스크립트]** `{{$node["Google Gemini (숏폼)"].json.text}}`
*(Tip: 데이터 관리가 목적이라면 Node 1의 원본 구글 시트에 옆 칸(Column)을 만들어 결과물을 텍스트로 바로 꽂아 넣게(Update Row) 설정할 수도 있습니다.)*

### Node 6. Slack / Discord / 메신저 알림
- 담당 에디터에게 메시지 발송: "🔥 {{$json.병원명}}의 초안 작성이 완료되었습니다. 링크에서 이미지 삽입 및 최종 검수를 진행해 주세요. [Google Docs 링크]"

---

## 3. Gemini API 활용 시 이점 및 주의사항

1. **컨텍스트 윈도우(Context Window)의 압도적 우위:** 
   Gemini 1.5 Pro는 한 번에 어마어마한 양의 텍스트(최대 200만 토큰)를 기억합니다. 만약 치과 원장님이 써둔 '과거 진료 철학 문서'나 '병원 소개서 PDF'가 따로 있다면, 이를 n8n 노드에서 몽땅 읽어 들여 System Prompt에 고정해 두세요. 치과마다 완전히 결이 다른(원장님 빙의율 99%) 맞춤형 글이 나옵니다.
2. **환각(Hallucination) 주의:**
   AI가 임의로 존재하지 않는 최신 장비(물방울 레이저 등)를 병원이 가지고 있다고 쓰지 않도록 주의해야 합니다. 프롬프트 마지막에 **"주어진 원장님 코멘트에 없는 장비나 기술적 스펙은 지어내지 마세요."**라는 제약 조건을 반드시 추가해야 의료법 리스크를 줄일 수 있습니다.
